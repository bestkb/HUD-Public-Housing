```{r}
library(tidyverse)
library(plotly)
library(readr)
library(webshot)
```

```{r}

state <- read_csv("../figures/stats_inspection_score_state.csv", show_col_types = FALSE)
year <- read_csv("../figures/stats_inspection_score_year.csv", show_col_types = FALSE)[-1, ]
```

```{r}
# Create choropleth map
fig <- plot_geo(state, locationmode = 'USA-states') %>%
  add_trace(
    z = ~mean,
    locations = ~state,
    text = ~state,
    colorscale = 'reds',
    colorbar = list(title = 'Mean Inspection Score')
  ) %>%
  layout(
    title = 'Mean Inspection Score by State',
    geo = list(scope = 'usa')
  )

# Show the plot
fig
plotly::write_image(fig, file = 'mean_inspection.png')
```


